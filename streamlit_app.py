import streamlit as st

# session_state ì´ˆê¸°í™”
# 'page' í‚¤ê°€ session_stateì— ì—†ìœ¼ë©´ 'home'ìœ¼ë¡œ ì„¤ì • (í˜ì´ì§€ ì´ë™ ê´€ë¦¬)
if 'page' not in st.session_state:
    st.session_state.page = 'home'

# ê° MBTI ì§€í‘œì— ëŒ€í•œ ì§ˆë¬¸ê³¼ ì„ íƒì§€ ì •ì˜
questions = {
    'EI': {
        'question': '1. ì—¬ëŸ¬ ì‚¬ëŒê³¼ í•¨ê»˜ ìˆì„ ë•Œ ì—ë„ˆì§€ê°€ ë„˜ì¹˜ë‚˜ìš”, ì•„ë‹ˆë©´ í˜¼ì ìˆì„ ë•Œ ì¶©ì „ë˜ë‚˜ìš”?',
        'options': {
            'ì—¬ëŸ¬ ì‚¬ëŒê³¼ í•¨ê»˜í•  ë•Œ ì—ë„ˆì§€ê°€ ë„˜ì³ìš”. (E)': 'E',
            'í˜¼ì ìˆì„ ë•Œ ì—ë„ˆì§€ê°€ ì¶©ì „ë¼ìš”. (I)': 'I'
        }
    },
    'SN': {
        'question': '2. ìƒˆë¡œìš´ ê²ƒì„ ë°°ìš¸ ë•Œ, ì‹¤ì œ ê²½í—˜ê³¼ ì‚¬ì‹¤ì— ì§‘ì¤‘í•˜ë‚˜ìš”, ì•„ë‹ˆë©´ ì´ë¡ ê³¼ ê°€ëŠ¥ì„±ì— ë” í¥ë¯¸ë¥¼ ëŠë¼ë‚˜ìš”?',
        'options': {
            'ì‹¤ì œ ê²½í—˜ê³¼ ì‚¬ì‹¤ì´ ì¤‘ìš”í•´ìš”. (S)': 'S',
            'ì´ë¡ ê³¼ ê°€ëŠ¥ì„±ì´ ë” í¥ë¯¸ë¡œì›Œìš”. (N)': 'N'
        }
    },
    'TF': {
        'question': '3. ê²°ì •ì„ ë‚´ë¦´ ë•Œ, ê°ê´€ì ì¸ ì‚¬ì‹¤ê³¼ ë…¼ë¦¬ë¥¼ ì¤‘ì‹œí•˜ë‚˜ìš”, ì•„ë‹ˆë©´ ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì™€ ê°ì •ì„ ë” ê³ ë ¤í•˜ë‚˜ìš”?',
        'options': {
            'ê°ê´€ì ì¸ ì‚¬ì‹¤ê³¼ ë…¼ë¦¬ê°€ ìš°ì„ ì´ì—ìš”. (T)': 'T',
            'ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì™€ ê°ì •ì´ ë” ì¤‘ìš”í•´ìš”. (F)': 'F'
        }
    },
    'JP': {
        'question': '4. ê³¼ì œë¥¼ í•  ë•Œ, ë¯¸ë¦¬ ê³„íšì„ ì„¸ìš°ê³  ì°¨ê·¼ì°¨ê·¼ ì§„í–‰í•˜ëŠ” í¸ì¸ê°€ìš”, ì•„ë‹ˆë©´ ë§ˆê° ì§ì „ì— ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” í¸ì¸ê°€ìš”?',
        'options': {
            'ê³„íšì„ ì„¸ì›Œì„œ ì°¨ê·¼ì°¨ê·¼ ì§„í–‰í•´ìš”. (J)': 'J',
            'ìƒí™©ì— ë§ì¶° ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•´ìš”. (P)': 'P'
        }
    },
    'EI_2': {
        'question': '5. ì£¼ë§ì— ì•½ì†ì´ ì—†ë‹¤ë©´, ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë©° ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?',
        'options': {
            'ì¹œêµ¬ë“¤ì„ ë§Œë‚˜ê±°ë‚˜ ìƒˆë¡œìš´ í™œë™ì„ ì°¾ì•„ë´ìš”. (E)': 'E',
            'ì§‘ì—ì„œ ì±…ì„ ì½ê±°ë‚˜ ì˜í™”ë¥¼ ë³´ë©° ì¡°ìš©íˆ ë³´ë‚´ìš”. (I)': 'I'
        }
    },
    'SN_2': {
        'question': '6. ê¸¸ì„ ì°¾ì„ ë•Œ, ìƒì„¸í•œ ì§€ë„ë¥¼ ë³´ê±°ë‚˜ ê¸¸ ì´ë¦„ì„ í™•ì¸í•˜ë‚˜ìš”, ì•„ë‹ˆë©´ í° ê±´ë¬¼ì´ë‚˜ ë°©í–¥ ê°ê°ì— ì˜ì¡´í•˜ë‚˜ìš”?',
        'options': {
            'ì§€ë„ë‚˜ í‘œì§€íŒì˜ ì„¸ë¶€ ì •ë³´ë¥¼ í™•ì¸í•´ìš”. (S)': 'S',
            'ì „ì²´ì ì¸ ë°©í–¥ê³¼ ê°ì„ ë¯¿ê³  ê°€ìš”. (N)': 'N'
        }
    }
}

# MBTI ìœ í˜•ë³„ í•™ìŠµ ìŠ¤íƒ€ì¼ ì„¤ëª… ë°ì´í„°
learning_styles = {
    'ISTJ': '**ì†Œê¸ˆí˜• ğŸ§‚:** ì„¸ìƒì˜ ë¹›ê³¼ ì†Œê¸ˆ! ê³„íšì ì´ê³  ì²´ê³„ì ì¸ í•™ìŠµì„ ì„ í˜¸í•´ìš”. ì¡°ìš©í•œ í™˜ê²½ì—ì„œ ì‚¬ì‹¤ì— ê¸°ë°˜í•œ ë‚´ìš©ì„ ìˆœì„œëŒ€ë¡œ ê³µë¶€í•  ë•Œ íš¨ìœ¨ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤. ê¼¼ê¼¼í•œ ë…¸íŠ¸ í•„ê¸°ê°€ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.',
    'ISFJ': '**ê¶Œë ¥í˜• ğŸ’ª:** ìš©ê°í•œ ìˆ˜í˜¸ì! ì¡°ìš©í•˜ê³  ì°¨ë¶„í•œ í™˜ê²½ì—ì„œ í•™ìŠµí•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì„ ë•ëŠ” ê³¼ì •ì—ì„œ ë” ì˜ ë°°ì›ë‹ˆë‹¤. ì‹¤ì œ ì‚¬ë¡€ë¥¼ í†µí•´ ê°œë…ì„ ì´í•´í•˜ëŠ” ê²ƒì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.',
    'INFJ': '**ì˜ˆì–¸ìí˜• ğŸ”®:** ì„ ì˜ì˜ ì˜¹í˜¸ì! í•™ìŠµ ë‚´ìš©ì´ ìì‹ ì—ê²Œ ì–´ë–¤ ì˜ë¯¸ê°€ ìˆëŠ”ì§€ íŒŒì•…í•˜ëŠ” ê²ƒì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•´ìš”. ê¹Šì´ ìˆëŠ” í† ë¡ ì´ë‚˜ ë…ì„œë¥¼ í†µí•´ ì˜ê°ì„ ì–»ìœ¼ë©° ê³µë¶€í•˜ëŠ” ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
    'INTJ': '**ê³¼í•™ìí˜• ğŸ”¬:** ìš©ì˜ì£¼ë„í•œ ì „ëµê°€! ë…ë¦½ì ì¸ í•™ìŠµì„ ì„ í˜¸í•˜ë©°, ë³µì¡í•œ ì´ë¡ ì´ë‚˜ ì‹œìŠ¤í…œì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ì„í•˜ê³  ì´í•´í•˜ëŠ” ë° ë›°ì–´ë‚©ë‹ˆë‹¤. ì¥ê¸°ì ì¸ ê³„íšì„ ì„¸ì›Œ ê³µë¶€í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.',
    'ISTP': '**ë°±ê³¼ì‚¬ì „í˜• ğŸ“–:** ë§ŒëŠ¥ ì¬ì£¼ê¾¼! ì§ì ‘ ì†ìœ¼ë¡œ ë§Œì§€ê³  ê²½í—˜í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ê°€ì¥ ì¢‹ì•„í•´ìš”. ì‹¤ìŠµ ìœ„ì£¼ì˜ ìˆ˜ì—…ì´ë‚˜ ë¬¸ì œ í•´ê²° ì¤‘ì‹¬ì˜ í•™ìŠµ ë°©ì‹ì´ ì˜ ë§ìŠµë‹ˆë‹¤.',
    'ISFP': '**ì„±ì¸êµ°ìí˜• ğŸ˜‡:** í˜¸ê¸°ì‹¬ ë§ì€ ì˜ˆìˆ ê°€! í¸ì•ˆí•˜ê³  ììœ ë¡œìš´ ë¶„ìœ„ê¸°ì—ì„œ í•™ìŠµí•  ë•Œ ëŠ¥ë¥ ì´ ì˜¬ë¼ìš”. ì‹œê° ìë£Œë‚˜ ì²´í—˜ í™œë™ì„ í†µí•´ í¥ë¯¸ë¥¼ ëŠë¼ê³ , ê°ì„±ì ìœ¼ë¡œ ì ‘ê·¼í•  ë•Œ ë” ì˜ ë°°ì›ë‹ˆë‹¤.',
    'INFP': '**ì”ë‹¤ë¥´í¬í˜• ğŸ”¥:** ì—´ì •ì ì¸ ì¤‘ì¬ì! ìì‹ ì´ ê°€ì¹˜ ìˆë‹¤ê³  ìƒê°í•˜ëŠ” ì£¼ì œì— ëŒ€í•´ ê¹Šì´ íŒŒê³ ë“œëŠ” ê²ƒì„ ì¢‹ì•„í•´ìš”. ìƒìƒë ¥ì„ ìê·¹í•˜ëŠ” ì´ì•¼ê¸°ë‚˜ ë¹„ìœ ë¥¼ í†µí•´ í•™ìŠµí•  ë•Œ íš¨ê³¼ì ì…ë‹ˆë‹¤.',
    'INTP': '**ì•„ì´ë””ì–´í˜• ğŸ’¡:** ë…¼ë¦¬ì ì¸ ì‚¬ìƒ‰ê°€! ì§€ì  í˜¸ê¸°ì‹¬ì´ ê°•í•´ í¥ë¯¸ ìˆëŠ” ë¶„ì•¼ëŠ” ë°¤ì„ ìƒˆì›Œì„œë¼ë„ íŒŒê³ ë“­ë‹ˆë‹¤. ììœ ë¡œìš´ í† ë¡ ê³¼ ë…¼ë¦¬ì  ë¶„ì„ì„ í†µí•´ ê°œë…ì„ ì™„ì„±í•´ë‚˜ê°€ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤.',
    'ESTP': '**í™œë™ê°€í˜• ğŸƒ:** ëª¨í—˜ì„ ì¦ê¸°ëŠ” ì‚¬ì—…ê°€! ì—­ë™ì ì´ê³  í™œë™ì ì¸ í™˜ê²½ì—ì„œ ì§ì ‘ ë¶€ë”ªíˆë©° ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•´ìš”. ê²½ìŸì´ë‚˜ ê²Œì„ ìš”ì†Œë¥¼ í™œìš©í•œ í•™ìŠµì´ íš¨ê³¼ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    'ESFP': '**ì‚¬êµí˜• ğŸ‰:** ììœ ë¡œìš´ ì˜í˜¼ì˜ ì—°ì˜ˆì¸! ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ì–´ìš¸ë¦¬ë©° ì¦ê²ê²Œ ê³µë¶€í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•´ìš”. ê·¸ë£¹ ìŠ¤í„°ë””ë‚˜ ë°œí‘œ, ì—­í• ê·¹ ë“±ì„ í†µí•´ í•™ìŠµ íš¨ê³¼ë¥¼ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    'ENFP': '**ìŠ¤íŒŒí¬í˜• âœ¨:** ì¬ê¸°ë°œë„í•œ í™œë™ê°€! ì°½ì˜ì ì´ê³  ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ë”±ë”±í•œ ê³„íšë³´ë‹¤ëŠ” ë¸Œë ˆì¸ìŠ¤í† ë°ì´ë‚˜ ììœ ë¡œìš´ í† ë¡  ì†ì—ì„œ ë” ë§ì€ ê²ƒì„ ë°°ì›ë‹ˆë‹¤.',
    'ENTP': '**ë°œëª…ê°€í˜• ğŸš€:** ëœ¨ê±°ìš´ ë…¼ìŸì„ ì¦ê¸°ëŠ” ë³€ë¡ ê°€! ì§€ì ì¸ ë„ì „ì„ ì¦ê¸°ë©°, ê¸°ì¡´ì˜ ë°©ì‹ì— ì˜ë¬¸ì„ ì œê¸°í•˜ê³  í† ë¡ í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•´ìš”. ë³µì¡í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©° ìì‹ ë§Œì˜ ë…¼ë¦¬ë¥¼ ë§Œë“¤ì–´ê°ˆ ë•Œ í¬ì—´ì„ ëŠë‚ë‹ˆë‹¤.',
    'ESTJ': '**ì‚¬ì—…ê°€í˜• ğŸ¢:** ì—„ê²©í•œ ê´€ë¦¬ì! ëª©í‘œê°€ ëª…í™•í•˜ê³  ì²´ê³„ì ì¸ í•™ìŠµ í™˜ê²½ì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì •í•´ì§„ ê³„íšì— ë”°ë¼ íš¨ìœ¨ì ìœ¼ë¡œ ê³µë¶€í•˜ê³ , ì‹¤ì§ˆì ì¸ ê²°ê³¼ë¥¼ ì–»ëŠ” ê²ƒì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.',
    'ESFJ': '**ì¹œì„ ë„ëª¨í˜• ğŸ¤:** ì‚¬êµì ì¸ ì™¸êµê´€! ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ êµë¥˜í•˜ê³  í˜‘ë ¥í•˜ë©° ê³µë¶€í•  ë•Œ ê°€ì¥ íš¨ìœ¨ì ì…ë‹ˆë‹¤. ìŠ¤í„°ë”” ê·¸ë£¹ì˜ ë¦¬ë” ì—­í• ì„ ë§¡ê±°ë‚˜, ì¹œêµ¬ë¥¼ ê°€ë¥´ì³ì£¼ë©´ì„œ ë” ê¹Šì´ ì´í•´í•˜ê²Œ ë©ë‹ˆë‹¤.',
    'ENFJ': '**ì–¸ë³€ëŠ¥ìˆ™í˜• ğŸ¤:** ì •ì˜ë¡œìš´ ì‚¬íšŒìš´ë™ê°€! ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ ê¸ì •ì ì¸ ì˜í–¥ì„ ì£¼ëŠ” í•™ìŠµì„ ì„ í˜¸í•´ìš”. ì—´ì •ì ì¸ í† ë¡ ì´ë‚˜ ë°œí‘œë¥¼ í†µí•´ ìì‹ ì˜ ì‹ ë…ì„ ê³µìœ í•˜ë©° ì„±ì¥í•˜ëŠ” ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
    'ENTJ': '**ì§€ë„ìí˜• ğŸ‘‘:** ëŒ€ë‹´í•œ í†µì†”ì! ëª©í‘œ ì§€í–¥ì ì´ë©°, í•™ìŠµ ë‚´ìš©ì„ ì „ëµì ìœ¼ë¡œ íŒŒì•…í•˜ê³  ì´ëŒì–´ë‚˜ê°€ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•©ë‹ˆë‹¤. íŒ€ í”„ë¡œì íŠ¸ë¥¼ ì´ëŒê±°ë‚˜ ë¦¬ë”ì‹­ì„ ë°œíœ˜í•  ìˆ˜ ìˆëŠ” í•™ìŠµ í™˜ê²½ì—ì„œ ë›°ì–´ë‚œ ì„±ê³¼ë¥¼ ë³´ì…ë‹ˆë‹¤.'
}

def home_page():
    """ë©”ì¸ í˜ì´ì§€(ì§ˆë¬¸ í˜ì´ì§€)ë¥¼ ë Œë”ë§í•˜ëŠ” í•¨ìˆ˜"""
    st.title("ğŸš€ MBTI í•™ìŠµ ìœ í˜• ì§„ë‹¨")
    st.markdown("---")
    st.subheader("ì•„ë˜ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”!")

    # ì‚¬ìš©ìì˜ ë‹µë³€ì„ ì €ì¥í•  ë”•ì…”ë„ˆë¦¬
    answers = {}
    for key, value in questions.items():
        # ë¼ë””ì˜¤ ë²„íŠ¼ìœ¼ë¡œ ì§ˆë¬¸ í‘œì‹œ, ì„ íƒëœ ì˜µì…˜ì˜ valueë¥¼ ì €ì¥
        answers[key] = st.radio(value['question'], list(value['options'].keys()))

    # 'ì œì¶œ' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
    if st.button("ê²°ê³¼ í™•ì¸í•˜ê¸°", type="primary"):
        st.session_state.answers = answers  # ë‹µë³€ì„ ì„¸ì…˜ ìƒíƒœì— ì €ì¥
        st.session_state.page = 'result'  # í˜ì´ì§€ ìƒíƒœë¥¼ 'result'ë¡œ ë³€ê²½
        st.rerun() # í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë³€ê²½ëœ ìƒíƒœë¥¼ ì¦‰ì‹œ ë°˜ì˜

def result_page():
    """ê²°ê³¼ í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” í•¨ìˆ˜"""
    st.title("ğŸ” ì§„ë‹¨ ê²°ê³¼")
    st.markdown("---")

    answers = st.session_state.get('answers', {})
    if not answers:
        st.error("ì§„ë‹¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. í™ˆìœ¼ë¡œ ëŒì•„ê°€ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")
        if st.button("í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°"):
            st.session_state.page = 'home'
            st.rerun()
        return

    # ê° ì§€í‘œë³„ ì ìˆ˜ ê³„ì‚°
    scores = {'E': 0, 'I': 0, 'S': 0, 'N': 0, 'T': 0, 'F': 0, 'J': 0, 'P': 0}
    for key, answer in answers.items():
        # ì„ íƒëœ ì˜µì…˜ì— í•´ë‹¹í•˜ëŠ” MBTI ì½”ë“œ (E, I, S, N ë“±)
        mbti_char = questions[key]['options'][answer]
        scores[mbti_char] += 1

    # ìµœì¢… MBTI ìœ í˜• ê²°ì •
    mbti_type = ""
    mbti_type += 'E' if scores['E'] > scores['I'] else 'I'
    mbti_type += 'S' if scores['S'] > scores['N'] else 'N'
    mbti_type += 'T' if scores['T'] > scores['F'] else 'F'
    mbti_type += 'J' if scores.get('J', 0) > scores.get('P', 0) else 'P'

    # ê²°ê³¼ ì¶œë ¥
    st.subheader(f"ë‹¹ì‹ ì˜ í•™ìŠµ ìœ í˜•ì€: **{mbti_type}** ì…ë‹ˆë‹¤!")
    st.markdown(f"> {learning_styles.get(mbti_type, 'ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')}")
    st.markdown("---")

    # í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼
    if st.button("ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°"):
        st.session_state.page = 'home'
        # ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”ë¥¼ ìœ„í•´ ê´€ë ¨ í‚¤ ì‚­ì œ
        if 'answers' in st.session_state:
            del st.session_state['answers']
        st.rerun()

# st.session_state.page ê°’ì— ë”°ë¼ ì ì ˆí•œ í˜ì´ì§€ í•¨ìˆ˜ í˜¸ì¶œ
if st.session_state.page == 'home':
    home_page()
elif st.session_state.page == 'result':
    result_page()
